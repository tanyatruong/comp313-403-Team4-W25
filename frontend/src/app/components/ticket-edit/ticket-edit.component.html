<!-- Modern Edit Ticket Page -->
<div class="ticket-edit-container">
  <!-- Header Section -->
  <header class="ticket-edit-header">
    <div class="header-content">
      <div class="header-left">
        <button class="back-btn" (click)="cancel()">
          <i class="pi pi-arrow-left"></i>
        </button>
        <div class="header-title">
          <h1>Edit Ticket</h1>
          <span>Update ticket details and status</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="ticket-edit-main">
    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-alert">
      <i class="pi pi-exclamation-triangle"></i>
      <span>{{ errorMessage }}</span>
    </div>

    <!-- Loading State -->
    <div *ngIf="!ticket" class="loading-state">
      <div class="loading-spinner">
        <i class="pi pi-spin pi-spinner"></i>
      </div>
      <p>Loading ticket details...</p>
    </div>

    <!-- Edit Form -->
    <div *ngIf="ticket" class="ticket-form-card">
      <form #ticketForm="ngForm" (ngSubmit)="saveTicket()" class="ticket-form">
        <div class="form-section">
          <h3>Ticket Information</h3>

          <div class="form-group">
            <label for="title">
              <i class="pi pi-bookmark"></i>
              Title
              <span class="required">*</span>
            </label>
            <input 
              id="title" 
              type="text" 
              class="form-input"
              [(ngModel)]="ticket.title" 
              name="title" 
              required
              placeholder="Enter ticket title"
            >
          </div>

          <div class="form-group">
            <label for="description">
              <i class="pi pi-file-edit"></i>
              Description
              <span class="required">*</span>
            </label>
            <textarea 
              id="description" 
              class="form-textarea"
              [(ngModel)]="ticket.description" 
              name="description" 
              required 
              rows="5"
              placeholder="Describe the issue in detail"
            ></textarea>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label for="status">
                <i class="pi pi-sync"></i>
                Status
                <span class="required">*</span>
              </label>
              <p-dropdown 
                id="status" 
                [options]="statusOptions" 
                [(ngModel)]="ticket.status" 
                optionLabel="label"
                optionValue="value" 
                name="status" 
                class="form-dropdown" 
                required>
              </p-dropdown>
            </div>

            <div class="form-group">
              <label for="priority">
                <i class="pi pi-exclamation-triangle"></i>
                Priority
                <span class="required">*</span>
              </label>
              <p-dropdown 
                id="priority" 
                [options]="priorityOptions" 
                [(ngModel)]="ticket.priority" 
                name="priority"
                class="form-dropdown" 
                required>
              </p-dropdown>
            </div>

            <div class="form-group">
              <label for="category">
                <i class="pi pi-tag"></i>
                Category
                <span class="required">*</span>
              </label>
              <p-dropdown 
                id="category" 
                [options]="categoryOptions" 
                [(ngModel)]="ticket.category" 
                name="category"
                class="form-dropdown" 
                required>
              </p-dropdown>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button 
            type="button" 
            class="action-btn secondary"
            (click)="cancel()">
            <i class="pi pi-times"></i>
            Cancel
          </button>
          <button 
            type="submit" 
            class="action-btn primary"
            [disabled]="!ticketForm.valid">
            <i class="pi pi-check"></i>
            Save Changes
          </button>
        </div>
      </form>
    </div>
  </main>

  <!-- Floating Chat Button -->
  <button class="chat-toggle" (click)="showChatbot = !showChatbot">
    <i class="pi pi-comments"></i>
    <span>Support</span>
  </button>

  <!-- Chat Panel -->
  <div class="chat-panel" [class.open]="showChatbot">
    <div class="chat-header">
      <span>Support Chat</span>
      <button class="chat-close" (click)="showChatbot = false">
        <i class="pi pi-times"></i>
      </button>
    </div>
    <div class="chat-content">
      <iframe 
        width="100%" 
        height="100%" 
        allow="microphone *" 
        src="https://www.gptbots.ai/widget/eeq5jnc8zz3glsfgnw7t8mq/chat.html"
        frameborder="0">
      </iframe>
    </div>
  </div>

  <!-- Overlay -->
  <div class="chat-overlay" [class.active]="showChatbot" (click)="showChatbot = false"></div>
</div>