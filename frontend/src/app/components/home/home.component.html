<!-- Modern Employee Dashboard -->
<div class="dashboard-container">
  <!-- Header Section -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="header-left">
        <div class="logo-section">
          <img src="assets/images/icons/noun-bunny_purple.png" alt="HoppeR" class="header-logo">
          <div class="header-title">
            <h1>HoppeR</h1>
            <span>Employee Dashboard</span>
          </div>
        </div>
      </div>
      
      <div class="header-right">
        <!-- User Info -->
        <div class="user-info" *ngIf="userService.getLoggedInUser()">
          <div class="user-avatar">
            <i class="pi pi-user"></i>
          </div>
          <div class="user-details">
            <span class="user-name">{{ userService.getLoggedInUser()?.name }}</span>
            <span class="user-role">{{ userService.getLoggedInUser()?.role }}</span>
          </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="header-actions">
          <button 
            class="action-btn secondary" 
            (click)="navigateToHRDashboard()"
            title="HR Dashboard">
            <i class="pi pi-th-large"></i>
            <span>HR Dashboard</span>
          </button>
          
          <button 
            class="action-btn primary" 
            (click)="openUserEdit()"
            title="Profile Settings">
            <i class="pi pi-cog"></i>
            <span>Profile</span>
          </button>
          
          <button 
            class="action-btn danger" 
            (click)="logout()"
            title="Logout">
            <i class="pi pi-sign-out"></i>
            <span>Logout</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="dashboard-main">
    <!-- Stats Cards -->
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card open">
          <div class="stat-icon">
            <i class="pi pi-circle"></i>
          </div>
          <div class="stat-content">
            <span class="stat-number">{{openTickets.length}}</span>
            <span class="stat-label">Open Tickets</span>
          </div>
        </div>
        
        <div class="stat-card progress">
          <div class="stat-icon">
            <i class="pi pi-clock"></i>
          </div>
          <div class="stat-content">
            <span class="stat-number">{{inProgressTickets.length}}</span>
            <span class="stat-label">In Progress</span>
          </div>
        </div>
        
        <div class="stat-card resolved">
          <div class="stat-icon">
            <i class="pi pi-check-circle"></i>
          </div>
          <div class="stat-content">
            <span class="stat-number">{{resolvedTickets.length}}</span>
            <span class="stat-label">Resolved</span>
          </div>
        </div>
        
        <div class="stat-card total">
          <div class="stat-icon">
            <i class="pi pi-ticket"></i>
          </div>
          <div class="stat-content">
            <span class="stat-number">{{filteredTickets.length}}</span>
            <span class="stat-label">Total Tickets</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Tickets Section -->
    <div class="tickets-section">
      <div class="section-header">
        <h2>My Tickets</h2>
        <button class="create-ticket-btn" (click)="addTicket()">
          <i class="pi pi-plus"></i>
          Create New Ticket
        </button>
      </div>

      <!-- No Tickets State -->
      <div *ngIf="filteredTickets.length === 0" class="empty-state">
        <div class="empty-icon">
          <i class="pi pi-inbox"></i>
        </div>
        <h3>No tickets found</h3>
        <p>You haven't created any tickets yet. Click the button above to get started.</p>
      </div>

      <!-- Tickets Grid -->
      <div *ngIf="filteredTickets.length > 0" class="tickets-grid">
        <!-- Open Tickets -->
        <div *ngFor="let ticket of openTickets" class="ticket-card-modern open">
          <div class="ticket-header">
            <div class="ticket-status-badge open">
              <i class="pi pi-circle"></i>
              Open
            </div>
            <div class="ticket-priority" [ngClass]="'priority-' + (ticket.priority || 'medium').toLowerCase()">
              {{ ticket.priority || 'Medium' }}
            </div>
          </div>
          
          <div class="ticket-content">
            <h3 class="ticket-title">{{ ticket.title }}</h3>
            <p class="ticket-description">{{ ticket.description }}</p>
            
            <div class="ticket-meta">
              <span class="ticket-category">
                <i class="pi pi-tag"></i>
                {{ ticket.category || 'General' }}
              </span>
              <span class="ticket-date">
                <i class="pi pi-calendar"></i>
                {{ ticket.createdAt | date:'short' }}
              </span>
            </div>
          </div>
          
          <div class="ticket-actions">
            <button class="action-btn-small primary" (click)="editTicket(ticket)">
              <i class="pi pi-pencil"></i>
              Update
            </button>
            <button *ngIf="ticket.id" class="action-btn-small danger" (click)="deleteTicket(ticket.id)">
              <i class="pi pi-trash"></i>
              Delete
            </button>
          </div>
        </div>

        <!-- In Progress Tickets -->
        <div *ngFor="let ticket of inProgressTickets" class="ticket-card-modern progress">
          <div class="ticket-header">
            <div class="ticket-status-badge progress">
              <i class="pi pi-clock"></i>
              In Progress
            </div>
            <div class="ticket-priority" [ngClass]="'priority-' + (ticket.priority || 'medium').toLowerCase()">
              {{ ticket.priority || 'Medium' }}
            </div>
          </div>
          
          <div class="ticket-content">
            <h3 class="ticket-title">{{ ticket.title }}</h3>
            <p class="ticket-description">{{ ticket.description }}</p>
            
            <div class="ticket-meta">
              <span class="ticket-category">
                <i class="pi pi-tag"></i>
                {{ ticket.category || 'General' }}
              </span>
              <span class="ticket-date">
                <i class="pi pi-calendar"></i>
                {{ ticket.createdAt | date:'short' }}
              </span>
            </div>
          </div>
          
          <div class="ticket-actions">
            <button class="action-btn-small primary" (click)="editTicket(ticket)">
              <i class="pi pi-pencil"></i>
              Update
            </button>
            <button *ngIf="ticket.id" class="action-btn-small danger" (click)="deleteTicket(ticket.id)">
              <i class="pi pi-trash"></i>
              Delete
            </button>
          </div>
        </div>

        <!-- Resolved Tickets -->
        <div *ngFor="let ticket of resolvedTickets" class="ticket-card-modern resolved">
          <div class="ticket-header">
            <div class="ticket-status-badge resolved">
              <i class="pi pi-check-circle"></i>
              Resolved
            </div>
            <div class="ticket-priority" [ngClass]="'priority-' + (ticket.priority || 'medium').toLowerCase()">
              {{ ticket.priority || 'Medium' }}
            </div>
          </div>
          
          <div class="ticket-content">
            <h3 class="ticket-title">{{ ticket.title }}</h3>
            <p class="ticket-description">{{ ticket.description }}</p>
            
            <div class="ticket-meta">
              <span class="ticket-category">
                <i class="pi pi-tag"></i>
                {{ ticket.category || 'General' }}
              </span>
              <span class="ticket-date">
                <i class="pi pi-calendar"></i>
                {{ ticket.createdAt | date:'short' }}
              </span>
            </div>
          </div>
          
          <div class="ticket-actions">
            <button class="action-btn-small primary" (click)="editTicket(ticket)">
              <i class="pi pi-pencil"></i>
              View
            </button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Floating Chat Button -->
  <button class="chat-toggle" (click)="showChatbot = !showChatbot">
    <i class="pi pi-comments"></i>
    <span>Chat Support</span>
  </button>

  <!-- Chat Panel -->
  <div class="chat-panel" [class.open]="showChatbot">
    <div class="chat-header">
      <span>Support Chat</span>
      <button class="chat-close" (click)="showChatbot = false">
        <i class="pi pi-times"></i>
      </button>
    </div>
    <div class="chat-content">
      <iframe 
        width="100%" 
        height="100%" 
        allow="microphone *" 
        src="https://www.gptbots.ai/widget/eeq5jnc8zz3glsfgnw7t8mq/chat.html"
        frameborder="0">
      </iframe>
    </div>
  </div>

  <!-- Overlay -->
  <div class="chat-overlay" [class.active]="showChatbot" (click)="showChatbot = false"></div>

  <!-- Delete Confirmation Modal -->
  <div *ngIf="showDeleteModal" class="modal-overlay">
    <div class="modal-content">
      <h3>Confirm Deletion</h3>
      <p>Are you sure you want to delete this ticket? This action cannot be undone.</p>
      <div class="modal-actions">
        <button class="action-btn-small danger" (click)="confirmDelete()">
          <i class="pi pi-check"></i>
          Yes, Delete
        </button>
        <button class="action-btn-small secondary" (click)="cancelDelete()">
          <i class="pi pi-times"></i>
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>
